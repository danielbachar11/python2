name: Docker Login

on: push

jobs:
  docker-login:
    runs-on: arc-daniel
    steps:
      - name: Check out the repository
        uses: actions/checkout@v3
       

      - name: Set up kubectl
        run: |
          apt-get update
 
          apt-get install -y apt-transport-https ca-certificates curl gnupg
          curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.30/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
          chmod 644 /etc/apt/keyrings/kubernetes-apt-keyring.gpg # allow unprivileged APT programs to read this keyring
          echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.30/deb/ /' | sudo tee /etc/apt/sources.list.d/kubernetes.list
          chmod 644 /etc/apt/sources.list.d/kubernetes.list
          apt-get update
          apt-get install -y kubectl
      - name: Authenticate with Kubernetes cluster
        env:
          KUBECONFIG: ${{ secrets.KUBECONFIG }}  
        run: |
          echo "$KUBECONFIG" > $HOME/.kube/config
          chmod 600 $HOME/.kube/config

      - name: Apply Kubernetes manifests
        run: kubectl get pod -n runner

     
